<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Danh Sách Học Sinh Đạt Giải Toán</title>
  <meta name="description" content="Danh sách học sinh đạt giải môn Toán cấp tỉnh từ năm học 2017 đến nay." />
  <style>
    /* === CSS gốc của bạn đã được giữ nguyên và tối ưu nhẹ === */
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
    body { background: #f5f5f5; padding: 20px; }
    .container { max-width: 1200px; margin: auto; background: #fff; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); padding: 20px; }
    .header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #e0e0e0; }
    .header h1 { color: #2c3e50; margin-bottom: 15px; }
    .search-container { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px; border: 1px solid #dee2e6; }
    .search-box { display: flex; gap: 10px; flex-wrap: wrap; }
    .search-input { flex: 1; min-width: 200px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px; }
    .search-btn { background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; transition: background 0.3s; }
    .search-btn:hover { background: #2980b9; }
    .stats, .prize-stats { padding: 15px; border-radius: 5px; margin-bottom: 20px; text-align: center; font-weight: bold; color: #2c3e50; }
    .stats { background: #e8f4fc; }
    .prize-stats { background: #fff3cd; border: 1px solid #ffeaa7; font-weight: normal; }
    .academic-year { color: #2c3e50; margin: 30px 0 15px 0; padding-bottom: 8px; border-bottom: 2px solid #3498db; }
    .table-container { overflow-x: auto; margin-bottom: 30px; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; table-layout: fixed; }
    th { background: #34495e; color: white; padding: 12px; text-align: left; font-weight: bold; }
    th:nth-child(1) { width: 60px; } th:nth-child(2) { width: 250px; } th:nth-child(3) { width: 80px; }
    th:nth-child(4) { width: 80px; } th:nth-child(5) { width: 120px; }
    td { padding: 12px; border-bottom: 1px solid #ddd; vertical-align: top; }
    tr:nth-child(even) { background: #fafafa; } tr:hover { background: #f0f8ff; }
    .student-info { display: flex; flex-direction: column; }
    .student-name { font-weight: bold; color: #2c3e50; margin-bottom: 8px; font-size: 14px; }
    .student-details { color: #555; font-size: 13px; font-style: normal; line-height: 1.4; }
    .prize-badge { display: inline-block; padding: 6px 10px; border-radius: 4px; font-weight: bold; text-align: center; min-width: 60px; font-size: 13px; }
    .prize-1 { background: #fff9c4; color: #f57f17; border: 1px solid #ffd54f; }
    .prize-2 { background: #f5f5f5; color: #616161; border: 1px solid #e0e0e0; }
    .prize-3 { background: #ffecb3; color: #e65100; border: 1px solid #ffd54f; }
    .prize-kk { background: #ffcdd2; color: #c62828; border: 1px solid #ef9a9a; }
    td:nth-child(1), td:nth-child(2), td:nth-child(3), td:nth-child(5) { background: #f8f9fa; }
    .no-results { text-align: center; padding: 40px; color: #7f8c8d; font-style: italic; }

    @media (max-width: 768px) {
      .container { padding: 10px; }
      th, td { padding: 10px 8px; font-size: 13px; }
      .search-box { flex-direction: column; }
      .search-input { min-width: 100%; }
      th:nth-child(1) { width: 50px; }
      th:nth-child(2) { width: 200px; }
      th:nth-child(3) { width: 70px; }
      th:nth-child(4) { width: 70px; }
      th:nth-child(5) { width: 100px; }
      .student-name { font-size: 13px; }
      .student-details { font-size: 12px; }
      .prize-badge { padding: 4px 8px; font-size: 12px; min-width: 50px; }
    }

    @media (max-width: 480px) {
      .header h1 { font-size: 20px; }
      th, td { padding: 8px 6px; font-size: 12px; }
      .student-details { font-size: 11px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>DANH SÁCH HỌC SINH ĐẠT GIẢI MÔN TOÁN</h1>
      <h2>CẤP TỈNH/TP, TỪ 2017</h2>
      <div class="stats">
        Tổng số lượt học sinh đạt giải: <span id="totalCount">0</span>.
      </div>
      <div class="prize-stats" id="prizeStats"></div>
    </div>

    <div class="search-container">
      <div class="search-box">
        <input type="text" id="searchInput" class="search-input" placeholder="Tìm kiếm theo tên học sinh, giáo viên, lớp, giải thưởng..." />
        <button onclick="searchStudents()" class="search-btn">Tìm kiếm</button>
      </div>
    </div>

    <div id="resultsContainer"></div>
  </div>

  <!-- ==== TOÀN BỘ SCRIPT NẰM DƯỚI ĐÂY ==== -->
  <script>
    const studentsData = [...]; // Dán toàn bộ dữ liệu của bạn vào đây như trong file gốc

    function calculatePrizeStats(students) {
      const stats = { nhat: 0, nhi: 0, ba: 0, kk: 0 };
      students.forEach(s => {
        switch (s.prize) {
          case "Nhất": stats.nhat++; break;
          case "Nhì": stats.nhi++; break;
          case "Ba": stats.ba++; break;
          case "KK": stats.kk++; break;
        }
      });
      return stats;
    }

    function displayPrizeStats(students) {
      const stats = calculatePrizeStats(students);
      const el = document.getElementById("prizeStats");
      let txt = `Tổng số giải: ${students.length} (trong đó `;
      const parts = [];
      if (stats.nhat) parts.push(`${stats.nhat} giải Nhất`);
      if (stats.nhi) parts.push(`${stats.nhi} giải Nhì`);
      if (stats.ba) parts.push(`${stats.ba} giải Ba`);
      if (stats.kk) parts.push(`${stats.kk} giải KK`);
      txt += parts.join(", ") + ").";
      el.textContent = txt;
    }

    function displayStudents(students = studentsData) {
      const grouped = {};
      students.forEach(s => {
        if (!grouped[s.year]) grouped[s.year] = [];
        grouped[s.year].push(s);
      });

      let html = "";
      const years = Object.keys(grouped).sort((a, b) => b.localeCompare(a));
      years.forEach(year => {
        html += `<h2 class="academic-year">${year}</h2><div class="table-container"><table><thead>
          <tr><th>STT</th><th>Học sinh</th><th>Lớp</th><th>Giải</th><th>GV hướng dẫn</th></tr>
        </thead><tbody>`;
        grouped[year].forEach((s, idx) => {
          const prizeClass = {
            "Nhất": "prize-1",
            "Nhì": "prize-2",
            "Ba": "prize-3",
            "KK": "prize-kk"
          }[s.prize] || "";

          html += `<tr>
            <td>${idx + 1}</td>
            <td><div class="student-info">
              <div class="student-name">${s.name}</div>
              <div class="student-details">${s.school}</div>
            </div></td>
            <td>${s.class}</td>
            <td><span class="prize-badge ${prizeClass}">${s.prize}</span></td>
            <td>${s.teacher}</td>
          </tr>`;
        });
        html += "</tbody></table></div>";
      });

      document.getElementById("resultsContainer").innerHTML = html;
      document.getElementById("totalCount").textContent = students.length;
      displayPrizeStats(students);
    }

    function searchStudents() {
      const keyword = document.getElementById("searchInput").value.trim().toLowerCase();
      if (!keyword) {
        displayStudents();
        return;
      }

      const filtered = studentsData.filter(s =>
        s.name.toLowerCase().includes(keyword) ||
        s.teacher.toLowerCase().includes(keyword) ||
        s.class.toLowerCase().includes(keyword) ||
        s.school.toLowerCase().includes(keyword) ||
        s.prize.toLowerCase().includes(keyword)
      );

      if (filtered.length === 0) {
        document.getElementById("resultsContainer").innerHTML =
          `<div class="no-results">Không tìm thấy học sinh nào phù hợp với từ khóa "<strong>${keyword}</strong>".</div>`;
        document.getElementById("totalCount").textContent = 0;
        document.getElementById("prizeStats").textContent = "";
      } else {
        displayStudents(filtered);
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      displayStudents();
    });

    document.getElementById("searchInput").addEventListener("keypress", e => {
      if (e.key === "Enter") searchStudents();
    });
  </script>
</body>
</html>
